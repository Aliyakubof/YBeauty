<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YBeauty</title>
<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#fff;color:#333;}
.header-top{background:#ffb6c1;padding:10px 15px;display:flex;justify-content:space-between;align-items:center;}
.logo{font-weight:bold;font-size:22px;color:white;}
.search-box{background:white;border-radius:20px;display:flex;align-items:center;padding:3px 8px;}
.search-box input{border:none;outline:none;padding:5px;}
.search-box button{background:none;border:none;font-size:18px;cursor:pointer;color:#ff69b4;}
nav{background:#ffe4e9;display:flex;justify-content:center;gap:15px;padding:10px 0;}
nav a{text-decoration:none;color:#ff69b4;font-weight:500;}
nav a:hover{text-decoration:underline;}
.section{display:none;padding:20px;}
.section.active{display:block;}
.slider{position:relative;overflow:hidden;border-radius:10px;height:250px;}
.slides{display:flex;transition:transform 0.5s ease-in-out;}
.slides img{width:100%;height:100%;object-fit:cover;flex-shrink:0;}
.mini-cards{display:flex;overflow-x:auto;gap:10px;padding:10px 0;}
.mini-cards::-webkit-scrollbar{display:none;}
.card{background:white;border-radius:10px;padding:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);min-width:140px;text-align:center;flex-shrink:0;cursor:pointer;}
.card img{width:100%;border-radius:8px;}
.price{color:#ff69b4;font-weight:bold;}
table{border-collapse:collapse;width:100%;margin-top:20px;}
th,td{border:1px solid #ddd;padding:8px;text-align:center;}
th{background:#ffb6c1;color:white;}
form input,form button{padding:8px;margin:5px 0;width:100%;max-width:300px;}
form button{cursor:pointer;}
/* Modal */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;}
.modal-content{background:white;padding:20px;border-radius:10px;max-width:400px;width:90%;position:relative;}
.close{position:absolute;top:10px;right:10px;font-size:18px;cursor:pointer;}
</style>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
  import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBW6PoZ2TMbkHqetNiLt0rUivdgbsM6ivs",
    authDomain: "ybeauty-f45b6.firebaseapp.com",
    projectId: "ybeauty-f45b6",
    storageBucket: "ybeauty-f45b6.firebasestorage.app",
    messagingSenderId: "854762032933",
    appId: "1:854762032933:web:8c0004ca975950761294cc",
    measurementId: "G-N5FZ8YB698"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);

  window.firebaseDB = database; // global qilib oldik
</script>

</head>
<body>

<!-- HEADER -->
<div class="header-top">
<div class="logo">YBeauty</div>
<div class="search-box">
<input type="text" placeholder="Qidirish...">
<button>üîç</button>
</div>
</div>

<!-- NAV -->
<nav>
<a href="#" onclick="showSection('home')">Asosiy</a>
<a href="#" onclick="showSection('perfume')">Parfyumeriya</a>
<a href="#" onclick="showSection('cosmetics')">Kosmetika</a>
<a href="#" onclick="showSection('sale')">Aksiyalar</a>
<a href="#" onclick="showSection('admin')">üë§ Admin</a>
</nav>

<!-- HOME SECTION -->
<div id="home" class="section active">
<div class="slider">
<div class="slides" id="slides">
<img src="https://via.placeholder.com/600x250" alt="">
<img src="https://via.placeholder.com/600x250/ffb6c1" alt="">
<img src="https://via.placeholder.com/600x250/ffe4e9" alt="">
</div>
</div>

<h3>üõç Yangi kelganlar</h3>
<div class="mini-cards">
<div class="card" onclick="openModal('Perfume A', '120000', 'https://via.placeholder.com/150')"><img src="https://via.placeholder.com/150" alt=""><h4>Perfume A</h4><p class="price">120 000 so‚Äòm</p></div>
<div class="card" onclick="openModal('Lipstick B', '45000', 'https://via.placeholder.com/150')"><img src="https://via.placeholder.com/150" alt=""><h4>Lipstick B</h4><p class="price">45 000 so‚Äòm</p></div>
<div class="card" onclick="openModal('Foundation C', '80000', 'https://via.placeholder.com/150')"><img src="https://via.placeholder.com/150" alt=""><h4>Foundation C</h4><p class="price">80 000 so‚Äòm</p></div>
</div>
</div>

<!-- ADMIN PANEL -->
<div id="admin" class="section">
<h2>Admin Panel</h2>
<table id="ordersTable">
<tr><th>Sana</th><th>Ism</th><th>Telefon</th><th>Manzil</th><th>Mahsulot</th><th>Narx</th></tr>
</table>
</div>

<!-- MODAL -->
<div class="modal" id="orderModal">
<div class="modal-content">
<span class="close" onclick="closeModal()">‚úñ</span>
<img id="modalImage" src="" style="width:100%;border-radius:8px;">
<h3 id="modalProduct"></h3>
<p id="modalPrice" class="price"></p>
<form id="orderForm">
<input type="text" id="name" placeholder="Ism" required>
<input type="tel" id="phone" placeholder="Telefon" required>
<input type="text" id="address" placeholder="Manzil" required>
<button type="submit">Buyurtma berish</button>
</form>
</div>
</div>

<script>
// SECTION SWITCH
function showSection(sectionId){
  document.querySelectorAll('.section').forEach(sec=>sec.classList.remove('active'));
  document.getElementById(sectionId).classList.add('active');
}

// SLIDER
let index=0;
const slides=document.getElementById("slides");
const totalSlides=slides.children.length;
setInterval(()=>{index=(index+1)%totalSlides;slides.style.transform=`translateX(-${index*100}%)`;},3000);

let selectedProduct = { name: "", price: "", image: "" };

function openModal(name, price, image){
  selectedProduct = { name, price, image };
  document.getElementById("modalProduct").innerText = name;
  document.getElementById("modalPrice").innerText = price + " so‚Äòm";
  document.getElementById("modalImage").src = image;
  document.getElementById("orderModal").style.display = "flex";
}

function closeModal(){
  document.getElementById("orderModal").style.display = "none";
}

// BUYURTMA YUBORISH
document.getElementById("orderForm").addEventListener("submit", function(e){
  e.preventDefault();
  const db = window.firebaseDB;
  const { name, phone, address } = document.getElementById.bind(document);
  const data = {
    sana: new Date().toLocaleString(),
    ism: name.value,
    tel: phone.value,
    manzil: address.value,
    mahsulot: selectedProduct.name,
    narx: selectedProduct.price
  };
  push(ref(db, 'orders'), data)
    .then(()=>{ alert("‚úÖ Buyurtma yuborildi!"); document.getElementById("orderForm").reset(); closeModal(); })
    .catch(err=>alert("‚ùå Xatolik: " + err));
});

// LOAD ORDERS FOR ADMIN
function loadOrders(){
  const db = window.firebaseDB;
  const ordersRef = ref(db, 'orders');
  const table = document.getElementById("ordersTable");
  table.querySelectorAll("tr:not(:first-child)").forEach(tr => tr.remove());

  onValue(ordersRef, snapshot=>{
    table.querySelectorAll("tr:not(:first-child)").forEach(tr=>tr.remove());
    snapshot.forEach(childSnapshot=>{
      const o = childSnapshot.val();
      const row = table.insertRow();
      row.insertCell(0).innerText = o.sana;
      row.insertCell(1).innerText = o.ism;
      row.insertCell(2).innerText = o.tel;
      row.insertCell(3).innerText = o.manzil;
      row.insertCell(4).innerText = o.mahsulot;
      row.insertCell(5).innerText = o.narx;
    });
  });
  showSection("admin");
}

// Admin panelni avtomatik yuklash
document.addEventListener("DOMContentLoaded", loadOrders);
</script>

</body>
</html>
