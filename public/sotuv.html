<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YBeauty</title>
<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#fff;color:#333;}
.header-top{background:#ffb6c1;padding:10px 15px;display:flex;justify-content:space-between;align-items:center;}
.logo{font-weight:bold;font-size:22px;color:white;}
.search-box{background:white;border-radius:20px;display:flex;align-items:center;padding:3px 8px;}
.search-box input{border:none;outline:none;padding:5px;}
.search-box button{background:none;border:none;font-size:18px;cursor:pointer;color:#ff69b4;}
nav{background:#ffe4e9;display:flex;justify-content:center;gap:15px;padding:10px 0;}
nav a{text-decoration:none;color:#ff69b4;font-weight:500;}
nav a:hover{text-decoration:underline;}
.section{display:none;padding:20px;}
.section.active{display:block;}
.slider{position:relative;overflow:hidden;border-radius:10px;height:250px;}
.slides{display:flex;transition:transform 0.5s ease-in-out;}
.slides img{width:100%;height:100%;object-fit:cover;flex-shrink:0;}
.mini-cards{display:flex;overflow-x:auto;gap:10px;padding:10px 0;}
.mini-cards::-webkit-scrollbar{display:none;}
.card{background:white;border-radius:10px;padding:10px;box-shadow:0 2px 10px rgba(0,0,0,0.1);min-width:140px;text-align:center;flex-shrink:0;cursor:pointer;}
.card img{width:100%;border-radius:8px;}
.price{color:#ff69b4;font-weight:bold;}
/* Modal */
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;}
.modal-content{background:white;padding:20px;border-radius:10px;max-width:400px;width:90%;position:relative;}
.close{position:absolute;top:10px;right:10px;font-size:18px;cursor:pointer;}
</style>
</head>
<body>

<div class="header-top">
  <div class="logo">YBeauty</div>
  <div class="search-box">
    <input type="text" placeholder="Qidirish...">
    <button>üîç</button>
  </div>
</div>

<nav>
  <a href="#" onclick="showSection('home')">Asosiy</a>
  <a href="#" onclick="showSection('perfume')">Parfyumeriya</a>
  <a href="#" onclick="showSection('cosmetics')">Kosmetika</a>
  <a href="#" onclick="showSection('sale')">Aksiyalar</a>
  <a href="#" onclick="showSection('admin')">üë§</a>
</nav>

<div id="home" class="section active">
  <h3>üõç Yangi kelganlar</h3>
  <div class="mini-cards">
    <div class="card" onclick="openModal('Perfume A', '120000', 'https://via.placeholder.com/150')">
      <img src="https://via.placeholder.com/150" alt="">
      <h4>Perfume A</h4>
      <p class="price">120 000 so‚Äòm</p>
    </div>
    <div class="card" onclick="openModal('Lipstick B', '45000', 'https://via.placeholder.com/150')">
      <img src="https://via.placeholder.com/150" alt="">
      <h4>Lipstick B</h4>
      <p class="price">45 000 so‚Äòm</p>
    </div>
    <div class="card" onclick="openModal('Foundation C', '80000', 'https://via.placeholder.com/150')">
      <img src="https://via.placeholder.com/150" alt="">
      <h4>Foundation C</h4>
      <p class="price">80 000 so‚Äòm</p>
    </div>
  </div>
</div>

<div id="admin" class="section">
  <h2>Admin Panel</h2>
  <label>Admin kalitni kiriting:</label>
  <input type="password" id="adminKey">
  <button onclick="loadOrders()">Kirish</button>
  <table id="ordersTable">
    <tr><th>Sana</th><th>Ism</th><th>Telefon</th><th>Manzil</th><th>Mahsulot</th><th>Narx</th></tr>
  </table>
</div>

<div class="modal" id="orderModal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">‚úñ</span>
    <img id="modalImage" src="" style="width:100%;border-radius:8px;">
    <h3 id="modalProduct"></h3>
    <p id="modalPrice" class="price"></p>
    <form id="orderForm">
      <input type="text" id="name" placeholder="Ism" required>
      <input type="tel" id="phone" placeholder="Telefon" required>
      <input type="text" id="address" placeholder="Manzil" required>
      <button type="submit">Buyurtma berish</button>
    </form>
  </div>
</div>

<script>
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

let selectedProduct = { name:"", price:"", image:"" };

function openModal(name, price, image){
  selectedProduct = { name, price, image };
  document.getElementById("modalProduct").innerText=name;
  document.getElementById("modalPrice").innerText=price+" so‚Äòm";
  document.getElementById("modalImage").src=image;
  document.getElementById("orderModal").style.display="flex";
}

function closeModal(){ document.getElementById("orderModal").style.display="none"; }

document.getElementById("orderForm").addEventListener("submit", async function(e){
  e.preventDefault();
  let data={
    sana:new Date().toLocaleString(),
    ism:document.getElementById("name").value,
    tel:document.getElementById("phone").value,
    manzil:document.getElementById("address").value,
    mahsulot:selectedProduct.name,
    narx:selectedProduct.price
  };
  try{
    let res=await fetch("/api/orders",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify(data)
    });
    let result=await res.json();
    if(result.success){
      alert("‚úÖ Buyurtma yuborildi!");
      document.getElementById("orderForm").reset();
      closeModal();
    } else { alert("‚ùå Xatolik"); }
  }catch(err){ alert("‚ùå Server bilan aloqa xatosi"); }
});

async function loadOrders(){
  const key=document.getElementById("adminKey").value;
  if(!key){ alert("Kalit kiriting!"); return; }
  let res=await fetch(`/api/orders?key=${key}`);
  if(res.status===403){ alert("Siz admin emassiz!"); return; }
  let orders=await res.json();
  let table=document.getElementById("ordersTable");
  table.querySelectorAll("tr:not(:first-child)").forEach(tr=>tr.remove());
  orders.forEach(o=>{
    let row=table.insertRow();
    row.insertCell(0).innerText=o.sana;
    row.insertCell(1).innerText=o.ism;
    row.insertCell(2).innerText=o.tel;
    row.insertCell(3).innerText=o.manzil;
    row.insertCell(4).innerText=o.mahsulot;
    row.insertCell(5).innerText=o.narx;
  });
  showSection("admin");
}
</script>
</body>
</html>
