<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>YBeauty</title>

<!-- ====== STYLE ====== -->
<style>
  :root{
    --pink:#ff69b4;
    --pink-200:#ffe4e9;
    --pink-300:#ffb6c1;
    --ink:#333;
    --card-shadow:0 6px 18px rgba(0,0,0,.08);
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:ui-sans-serif,system-ui,"Segoe UI",Arial; color:var(--ink);background:#fff}
  /* Header */
  .header{background:var(--pink-300);padding:10px 16px;display:flex;align-items:center;justify-content:space-between;gap:12px;position:sticky;top:0;z-index:20}
  .logo{color:#fff;font-weight:700;font-size:22px;letter-spacing:.3px}
  .searchbar{display:flex;align-items:center;gap:8px;background:#fff;border-radius:999px;padding:6px 10px;min-width:240px;box-shadow:var(--card-shadow)}
  .searchbar input{border:none;outline:none;font-size:14px;flex:1}
  .icon-btn{border:none;background:transparent;cursor:pointer;font-size:20px;line-height:1;color:#fff;display:inline-flex;align-items:center;justify-content:center;transition:.15s transform}
  .icon-btn:active{transform:scale(.95)}
  /* Navbar */
  .navbar{background:var(--pink-200);display:flex;gap:18px;justify-content:center;align-items:center;padding:10px 8px;flex-wrap:wrap;position:sticky;top:56px;z-index:19}
  .nav-link{border:none;background:transparent;color:var(--pink);font-weight:600;cursor:pointer;padding:6px 10px;border-radius:8px;transition:.15s background}
  .nav-link.active,.nav-link:hover{background:#fff}
  /* Sections */
  .section{display:none;padding:18px;max-width:1100px;margin:0 auto}
  .section.active{display:block}
  /* Slider */
  .slider{position:relative;border-radius:14px;overflow:hidden;height:240px;margin-bottom:18px;box-shadow:var(--card-shadow)}
  .slides{display:flex;width:100%;height:100%;transition:transform .6s ease}
  .slides img{width:100%;height:100%;object-fit:cover;flex:1 0 100%}
  /* Mini-cards scroller */
  .mini{display:flex;gap:12px;overflow:auto;padding:6px 2px 10px}
  .mini::-webkit-scrollbar{display:none}
  .mini .card{min-width:150px}
  /* Grid cards */
  .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px}
  @media(min-width:720px){ .grid{grid-template-columns:repeat(4,minmax(0,1fr));} }
  .card{background:#fff;border-radius:14px;box-shadow:var(--card-shadow);overflow:hidden;cursor:pointer;transition:.18s transform}
  .card:active{transform:scale(.98)}
  .card img{width:100%;height:160px;object-fit:cover;display:block}
  .card .body{padding:10px}
  .title{font-size:14px;font-weight:600;margin:0 0 6px}
  .price{color:var(--pink);font-weight:700}
  h3.section-title{margin:8px 0 10px}
  /* Modal (product) */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:16px;z-index:40}
  .modal.open{display:flex}
  .modal-card{background:#fff;border-radius:18px;max-width:520px;width:100%;box-shadow:var(--card-shadow);overflow:hidden}
  .modal-media{width:100%;height:260px;object-fit:cover}
  .modal-body{padding:16px}
  .muted{color:#666;font-size:14px}
  .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .btn{border:none;border-radius:12px;padding:10px 14px;cursor:pointer;font-weight:700}
  .btn-primary{background:var(--pink);color:#fff}
  .btn-outline{background:#fff;border:2px solid var(--pink);color:var(--pink)}
  /* Order form inside modal */
  .form{display:grid;gap:10px;margin-top:12px}
  .input{width:100%;padding:10px 12px;border:1px solid #e7e7e7;border-radius:10px;font-size:14px}
  /* Admin */
  .admin-wrap{display:grid;gap:10px}
  table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:var(--card-shadow)}
  th,td{padding:10px 8px;border-bottom:1px solid #eee;text-align:left;font-size:14px}
  th{background:var(--pink-300);color:#fff}
  tr:last-child td{border-bottom:none}
  .pill{display:inline-block;background:#fff;color:#b30059;border:1px solid #ff99cc;padding:2px 8px;border-radius:999px;font-size:12px}
</style>

<!-- ====== Firebase SDK (ES modules) ====== -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.2.0/firebase-app.js";
  import { getDatabase, ref, push, get } from "https://www.gstatic.com/firebasejs/10.2.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBW6PoZ2TMbkHqetNiLt0rUivdgbsM6ivs",
    authDomain: "ybeauty-f45b6.firebaseapp.com",
    databaseURL: "https://ybeauty-f45b6-default-rtdb.firebaseio.com",
    projectId: "ybeauty-f45b6",
    storageBucket: "ybeauty-f45b6.appspot.com",
    messagingSenderId: "854762032933",
    appId: "1:854762032933:web:8c0004ca975950761294cc"
  };
  const app = initializeApp(firebaseConfig);
  const db  = getDatabase(app);

  const $ = s => document.querySelector(s);
  const $$ = s => document.querySelectorAll(s);

  // ====== DATA: Products ======
  const perfume = Array.from({length:10},(_,i)=>({
    id:`p${i+1}`, name:`Parfyum ${i+1}`, price: 90000 + i*5000,
    img:`https://images.unsplash.com/photo-1541643600914-78b084683601?q=80&w=800&auto=format&fit=crop`,
    desc:"Nozik gul notalari, kundalik va kechki chiqishlar uchun mos."
  }));
  const cosmetics = Array.from({length:10},(_,i)=>({
    id:`c${i+1}`, name:`Kosmetika ${i+1}`, price: 45000 + i*4000,
    img:`https://images.unsplash.com/photo-1512496015851-a90fb38ba796?q=80&w=800&auto=format&fit=crop`,
    desc:"Yuz terisini asraydigan, allergiyasiz, kundalik foydalanishga mos."
  }));
  const sales = Array.from({length:10},(_,i)=>({
    id:`s${i+1}`, name:`Chegirma ${i+1}`, price: 30000 + i*3000,
    img:`https://images.unsplash.com/photo-1585386959984-a41552231658?q=80&w=800&auto=format&fit=crop`,
    desc:"Cheklangan aksiya! Sifatli mahsulotga yoqimli narx."
  }));

  function money(n){ return n.toLocaleString('uz-UZ')+" so‘m"; }

  function renderCards(containerId, items){
    const wrap = document.getElementById(containerId);
    wrap.innerHTML = items.map(p=>`
      <div class="card" data-id="${p.id}" data-name="${p.name}" data-price="${p.price}" data-img="${p.img}" data-desc="${p.desc}">
        <img src="${p.img}" alt="${p.name}" loading="lazy"/>
        <div class="body">
          <p class="title">${p.name}</p>
          <div class="row"><span class="price">${money(p.price)}</span><span class="pill">Yangi</span></div>
        </div>
      </div>
    `).join('');
  }

  function renderMini(containerId, items){
    const el = document.getElementById(containerId);
    el.innerHTML = items.slice(0,6).map(p=>`
      <div class="card" style="min-width:160px" data-id="${p.id}" data-name="${p.name}" data-price="${p.price}" data-img="${p.img}" data-desc="${p.desc}">
        <img src="${p.img}" alt="${p.name}" loading="lazy"/>
        <div class="body">
          <p class="title" style="font-size:13px">${p.name}</p>
          <div class="price">${money(p.price)}</div>
        </div>
      </div>
    `).join('');
  }

  renderMini('mini-new', [...perfume, ...cosmetics]);
  renderCards('perfume-grid', perfume);
  renderCards('cosmetics-grid', cosmetics);
  renderCards('sales-grid', sales);

  const sections = ["home","perfume","cosmetics","sale","admin"];
  function showSection(id){
    sections.forEach(s=>{
      const el = document.getElementById(s);
      if(el) el.classList.toggle('active', s===id);
    });
    $$(".nav-link").forEach(b=>b.classList.toggle('active', b.dataset.target===id));
    window.scrollTo({top:0,behavior:'smooth'});
  }

  $$(".nav-link").forEach(btn=>{
    btn.addEventListener('click', e=>{
      e.preventDefault();
      showSection(btn.dataset.target);
    });
  });

  $("#adminBtn").addEventListener('click', ()=>showSection('admin'));

  const slider = $("#slides");
  let idx = 0;
  const total = slider.children.length;
  setInterval(()=>{
    idx = (idx+1)%total;
    slider.style.transform = `translateX(-${idx*100}%)`;
  }, 3000);

  const modal = $("#productModal");
  const modalImg = $("#mImg");
  const modalName = $("#mName");
  const modalDesc = $("#mDesc");
  const modalPrice = $("#mPrice");
  let selectedProduct = null;

  function openProduct(cardEl){
    const p = {
      id: cardEl.dataset.id,
      name: cardEl.dataset.name,
      price: Number(cardEl.dataset.price),
      img: cardEl.dataset.img,
      desc: cardEl.dataset.desc
    };
    selectedProduct = p;
    modalImg.src = p.img;
    modalName.textContent = p.name;
    modalDesc.textContent = p.desc;
    modalPrice.textContent = money(p.price);
    modal.classList.add('open');
  }
  function closeProduct(){ modal.classList.remove('open'); }

  document.addEventListener('click', (e)=>{
    const card = e.target.closest('.card');
    if(card && card.dataset.id){ openProduct(card); }
  });
  $("#closeModal").addEventListener('click', closeProduct);
  modal.addEventListener('click', e=>{ if(e.target===modal) closeProduct(); });

  $("#orderForm").addEventListener('submit', async (e)=>{
    e.preventDefault();
    if(!selectedProduct){ return; }
    const data = {
      sana: new Date().toLocaleString('uz-UZ'),
      ism: $("#fName").value.trim(),
      tel: $("#fPhone").value.trim(),
      manzil: $("#fAddr").value.trim(),
      mahsulot: selectedProduct.name,
      narx: selectedProduct.price
    };
    if(!data.ism || !data.tel || !data.manzil){
      alert("Iltimos, barcha maydonlarni to‘ldiring.");
      return;
    }
    await push(ref(db,'orders'), data);
    alert("✅ Buyurtma yuborildi!");
    e.target.reset();
    closeProduct();
  });

  // ====== ADMIN: orders load ======
  $("#loadBtn").addEventListener('click', async ()=>{
    const key = $("#adminKey").value.trim();
    if(key !== 'aass2617'){ alert("Siz admin emassiz!"); return; }

    const snap = await get(ref(db,'orders'));
    const orders = snap.val() || {};
    const tbody = $("#ordersBody");
    tbody.innerHTML = '';
    Object.values(orders).reverse().forEach(o=>{
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${o.sana||''}</td>
        <td>${o.ism||''}</td>
        <td>${o.tel||''}</td>
        <td>${o.manzil||''}</td>
        <td>${o.mahsulot||''}</td>
        <td>${o.narx?money(Number(o.narx)):'-'}</td>
      `;
      tbody.appendChild(tr);
    });
  });
</script>
</head>

<body>

<header class="header">
  <div class="logo">YBeauty</div>
  <div class="searchbar" style="flex:1;max-width:520px">
    <span>🔍</span>
    <input type="text" placeholder="Mahsulot qidirish..." />
  </div>
  <button id="adminBtn" class="icon-btn" title="Admin">👤</button>
</header>

<nav class="navbar">
  <button class="nav-link active" data-target="home">Asosiy</button>
  <button class="nav-link" data-target="perfume">Parfyumeriya</button>
  <button class="nav-link" data-target="cosmetics">Kosmetika</button>
  <button class="nav-link" data-target="sale">Aksiyalar</button>
</nav>

<section id="home" class="section active">
  <div class="slider">
    <div id="slides" class="slides">
      <img src="https://images.unsplash.com/photo-1556228453-efd1e3f0b8f3?q=80&w=1600&auto=format&fit=crop" alt="">
      <img src="https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?q=80&w=1600&auto=format&fit=crop" alt="">
      <img src="https://images.unsplash.com/photo-1556228578-0d85b1f9df71?q=80&w=1600&auto=format&fit=crop" alt="">
    </div>
  </div>
  <h3 class="section-title">🛍 Yangi kelganlar</h3>
  <div id="mini-new" class="mini"></div>
</section>

<section id="perfume" class="section">
  <h3 class="section-title">Parfyumeriya</h3>
  <div id="perfume-grid" class="grid"></div>
</section>

<section id="cosmetics" class="section">
  <h3 class="section-title">Kosmetika</h3>
  <div id="cosmetics-grid" class="grid"></div>
</section>

<section id="sale" class="section">
  <h3 class="section-title">Aksiyalar</h3>
  <div id="sales-grid" class="grid"></div>
</section>

<section id="admin" class="section">
  <h3 class="section-title">Admin Panel</h3>
  <div class="admin-wrap" style="max-width:860px;margin-inline:auto">
    <div class="row" style="gap:8px">
      <input id="adminKey" class="input" placeholder="Admin kalit..." type="password" style="max-width:260px">
      <button id="loadBtn" class="btn btn-outline">Kirish</button>
    </div>
    <div style="overflow:auto">
      <table>
        <thead>
          <tr>
            <th>Sana</th><th>Ism</th><th>Telefon</th><th>Manzil</th><th>Mahsulot</th><th>Narx</th>
          </tr>
        </thead>
        <tbody id="ordersBody"></tbody>
      </table>
    </div>
  </div>
</section>

<div id="productModal" class="modal" aria-hidden="true">
  <div class="modal-card">
    <img id="mImg" class="modal-media" alt="">
    <div class="modal-body">
      <div class="row">
        <h3 id="mName" style="margin:0"></h3>
        <div id="mPrice" class="price"></div>
      </div>
      <p id="mDesc" class="muted" style="margin:8px 0 12px"></p>

      <form id="orderForm" class="form">
        <input id="fName" class="input" placeholder="Ism" required />
        <input id="fPhone" class="input" placeholder="Telefon" required />
        <input id="fAddr" class="input" placeholder="Manzil" required />
        <div class="row">
          <button type="submit" class="btn btn-primary">Buyurtma berish</button>
          <button type="button" id="closeModal" class="btn">Yopish</button>
        </div>
      </form>
    </div>
  </div>
</div>

</body>
</html>
